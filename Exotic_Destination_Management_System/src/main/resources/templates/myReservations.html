<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="bg">
<head>
    <title>–ú–æ–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</title>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
    <style>
        /* üîî Notification Bell */
        .notification-container {
            position: fixed;
            top: 90px;
            right: 50px;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            font-size: 28px;
            background: white; /* Bright yellow background */
            border-radius: 50%;
            padding: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .notification-bell .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: red;
            color: white;
            border-radius: 50%;
            padding: 5px;
            font-size: 12px;
            font-weight: bold;
        }

        /* üîΩ Notification Dropdown */
        .dropdown {
            display: none;
            position: absolute;
            top: 50px;
            right: 0;
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            width: 280px;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease-in-out;
        }

        /* üìù Notification Card */
        .notification-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .notification-card span {
            font-weight: bold;
        }

        /* üî¥üü†üü¢ Days Left Badge */
        .days-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .red { background: #ff4d4d; color: white; }      /* 1 Day Left */
        .orange { background: #ffa500; color: white; }   /* 2-3 Days Left */
        .green { background: #4caf50; color: white; }    /* More than 3 Days */

        /* üé¨ Fade In Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body class="bg-gray-100 text-gray-800 pt-20 opacity-0 transition-opacity duration-700 ease-out">

<!-- Main Layout -->
<nav class="fixed top-0 w-full bg-white shadow-md backdrop-blur-md z-50">
    <div class="container mx-auto flex items-center justify-between py-4 px-6">

        <!-- Left Side: Logo -->
        <h2 class="text-3xl font-extrabold text-yellow-500"><a href="/">Exotico</a></h2>

        <!-- Center: Navigation Links -->
        <div class="hidden md:flex space-x-8 mx-auto">
            <a href="/destinations" class="text-lg font-semibold text-gray-700 hover:text-yellow-500 transition"> –î–µ—Å—Ç–∏–Ω–∞—Ü–∏–∏</a>
            <a href="/promotionsAndCampaigns" class="text-lg font-semibold text-gray-700 hover:text-yellow-500 transition">–ü—Ä–æ–º–æ—Ü–∏–∏</a>
            <a href="/statistics" class="text-lg font-semibold text-gray-700 hover:text-yellow-500 transition"> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</a>
        </div>

        <!-- Right Side: User Menu -->
        <div class="relative">
            <div class="bg-gray-800 text-white px-6 py-2 rounded-lg cursor-pointer flex items-center gap-2" id="userMenu">
                <span class="material-symbols-outlined">person</span>
                <span class="font-semibold">–ú–æ—è—Ç –∞–∫–∞—É–Ω—Ç</span>
            </div>

            <!-- Dropdown Menu -->
            <div id="dropdownMenu" class="absolute right-0 mt-2 bg-white text-gray-900 p-4 rounded shadow-md w-48 hidden transition">
                <a href="/profile" class="block py-2">–ü—Ä–æ—Ñ–∏–ª</a>
                <a href="/myReservations" class="block py-2">–ú–æ–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</a>
                <a href="/rateDestination" class="block py-2"> –î–æ–±–∞–≤–∏ —Ä–µ–π—Ç–∏–Ω–≥</a>
                <a href="/logout" class="block py-2 text-red-500">–ò–∑—Ö–æ–¥</a>
            </div>
        </div>
    </div>
</nav>

<!-- Content Section -->
<div class="container max-w-6xl mx-auto px-4 md:px-6 mt-12">
    <div class="notification-container">
        <!-- Notification Bell -->
        <div class="notification-bell" onclick="showNotifications()">
            üîî
            <span class="badge" th:if="${#lists.size(urgentReservations) > 0}" th:text="${#lists.size(urgentReservations)}"></span>
        </div>

        <!-- Notification Dropdown -->
        <div id="notificationDropdown" class="dropdown">
            <p th:if="${#lists.isEmpty(urgentReservations)}">‚úÖ –ù—è–º–∞ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏ –ø—ä—Ç—É–≤–∞–Ω–∏—è –ø—Ä–µ–∑ —Å–ª–µ–¥–≤–∞—â–∏—Ç–µ 3 –¥–Ω–∏</p>
            <div th:each="reservation : ${urgentReservations}" class="notification-card">
                <div>
                    <span th:text="${reservation.destination.name}"></span> <br>
                    <small th:text="${#temporals.format(reservation.destination.dateOfDeparture, 'dd MMM yyyy')}"></small>
                </div>
                <span class="days-badge"
                      th:classappend="${T(java.time.temporal.ChronoUnit).DAYS.between(T(java.time.LocalDate).now(), reservation.destination.dateOfDeparture) == 1 ? 'red' :
                                  (T(java.time.temporal.ChronoUnit).DAYS.between(T(java.time.LocalDate).now(), reservation.destination.dateOfDeparture) <= 3 ? 'orange' : 'green')}"
                      th:text="${T(java.time.temporal.ChronoUnit).DAYS.between(T(java.time.LocalDate).now(), reservation.destination.dateOfDeparture)} + ' –¥–Ω–∏'">
            </span>
            </div>
        </div>
    </div>

    <h1 class="text-4xl font-bold text-gray-800 mb-8 text-center">–ú–æ–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</h1>

    <!-- –ê–∫—Ç–∏–≤–Ω–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ -->
    <h2 class="text-2xl font-semibold text-gray-700 mb-4">–ê–∫—Ç–∏–≤–Ω–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</h2>
    <table class="min-w-full bg-white shadow-lg rounded-lg overflow-hidden">
        <thead>
        <tr class="bg-blue-700 text-white">
            <th class="px-6 py-3 text-left">–î–µ—Å—Ç–∏–Ω–∞—Ü–∏—è</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –∑–∞–º–∏–Ω–∞–≤–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –≤—Ä—ä—â–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–ë—Ä–æ–π —Ö–æ—Ä–∞</th>
            <th class="px-6 py-3 text-left">–û–±—â–∞ —Ü–µ–Ω–∞</th>
            <th class="px-6 py-3 text-left">–î–µ–π—Å—Ç–≤–∏–µ</th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="reservation : ${activeReservations}">
            <tr class="border-t hover:bg-gray-50">
                <td class="px-6 py-4" th:text="${reservation.destination.name}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfDeparture, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfReturn, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${reservation.numberOfPeople}"></td>
                <td class="px-6 py-4" th:text="${#numbers.formatDecimal(reservation.totalPrice, 2, 2)} + ' –ª–≤.'"></td>
                <td class="px-6 py-4">
                    <form th:action="@{/cancel-reservation/{id}(id=${reservation.id})}" method="post">
                        <button type="submit" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">–û—Ç–∫–∞–∂–∏</button>
                    </form>
                </td>
            </tr>
        </th:block>
        </tbody>
    </table>

    <!-- –û—Ç–º–µ–Ω–µ–Ω–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ -->
    <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-8">–û—Ç–º–µ–Ω–µ–Ω–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</h2>
    <table class="min-w-full bg-white shadow-lg rounded-lg overflow-hidden">
        <thead>
        <tr class="bg-blue-700 text-white">
            <th class="px-6 py-3 text-left">–î–µ—Å—Ç–∏–Ω–∞—Ü–∏—è</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –∑–∞–º–∏–Ω–∞–≤–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –≤—Ä—ä—â–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–ë—Ä–æ–π —Ö–æ—Ä–∞</th>
            <th class="px-6 py-3 text-left">–û–±—â–∞ —Ü–µ–Ω–∞</th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="reservation : ${canceledReservations}">
            <tr class="border-t hover:bg-gray-50">
                <td class="px-6 py-4" th:text="${reservation.destination.name}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfDeparture, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfReturn, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${reservation.numberOfPeople}"></td>
                <td class="px-6 py-4" th:text="${#numbers.formatDecimal(reservation.totalPrice, 2, 2)} + ' –ª–≤.'"></td>
            </tr>
        </th:block>
        </tbody>
    </table>

    <!-- –ú–∏–Ω–∞–ª–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ -->
    <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-8">–ú–∏–Ω–∞–ª–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏</h2>
    <table class="min-w-full bg-white shadow-lg rounded-lg overflow-hidden">
        <thead>
        <tr class="bg-blue-700 text-white">
            <th class="px-6 py-3 text-left">–î–µ—Å—Ç–∏–Ω–∞—Ü–∏—è</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –∑–∞–º–∏–Ω–∞–≤–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–î–∞—Ç–∞ –Ω–∞ –≤—Ä—ä—â–∞–Ω–µ</th>
            <th class="px-6 py-3 text-left">–ë—Ä–æ–π —Ö–æ—Ä–∞</th>
            <th class="px-6 py-3 text-left">–û–±—â–∞ —Ü–µ–Ω–∞</th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="reservation : ${pastReservations}">
            <tr class="border-t hover:bg-gray-50">
                <td class="px-6 py-4" th:text="${reservation.destination.name}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfDeparture, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${#temporals.format(reservation.destination.dateOfReturn, 'dd-MM-yyyy')}"></td>
                <td class="px-6 py-4" th:text="${reservation.numberOfPeople}"></td>
                <td class="px-6 py-4" th:text="${#numbers.formatDecimal(reservation.totalPrice, 2, 2)} + ' –ª–≤.'"></td>
            </tr>
        </th:block>
        </tbody>
    </table>
</div>
<div class="mb-10"></div>

<script>
    function showNotifications() {
        let dropdown = document.getElementById('notificationDropdown');
        dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
    }

    document.querySelector("#userMenu").addEventListener("click", () => {
        document.getElementById("dropdownMenu").classList.toggle("hidden");
    });

    document.addEventListener("DOMContentLoaded", function () {
        document.body.classList.remove("opacity-0");
    });
</script>

</body>
</html>
