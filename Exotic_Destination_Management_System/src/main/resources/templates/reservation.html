<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Make Reservation</title>
    <script>
        function updateTotalPrice() {
            let numberOfPeople = document.getElementById("numberOfPeople").value;
            let pricePerPerson = document.getElementById("pricePerPerson").value;
            let totalPrice = numberOfPeople * pricePerPerson;
            document.getElementById("totalPrice").innerText = totalPrice.toFixed(2) + " lv.";
        }
    </script>
</head>
<body>
<h1>Make Reservation</h1>
<br>
<div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 20px;">
    <h2 th:text="${destination.name}">Destination Name</h2>
    <img th:src="'/uploaded-image/' + ${destination.imageUrl}" alt="Destination Image">
    <p><strong>Description:</strong> <span th:text="${destination.description}">Destination Description</span></p>
    <p><strong>Departure date: </strong><span th:text="${#temporals.format(destination.dateOfDeparture, 'dd MMMM yyyy')}"></span></p>
    <p><strong>Return date: </strong><span th:text="${#temporals.format(destination.dateOfReturn, 'dd MMMM yyyy')}"></span></p>
    <p><strong>Price per person:</strong> <span th:text="${destination.price}"></span> lv.</p>
    <p><strong>Available spots:</strong> <span th:text="${destination.remainingPeople}"></span></p>
</div>

<form th:action="@{/destinations}" method="post">
    <input type="hidden" name="destinationId" th:value="${destination.id}">
    <input type="hidden" id="pricePerPerson" th:value="${destination.price}">

    <label>Name:</label>
    <input type="text" name="name" th:value="${#authentication.principal.firstName + ' ' + #authentication.principal.lastName}" readonly>
    <br><br>

    <label>Email:</label>
    <input type="email" name="email" th:value="${#authentication.principal.email}" readonly>
    <br><br>

    <label>Number of People:</label>
    <input type="number" id="numberOfPeople" name="numberOfPeople" required min="1"
           th:max="${destination.remainingPeople}" oninput="updateTotalPrice()">
    <br><br>

    <h3>Payment Information</h3>
    <label>Card Type:</label>
    <input type="radio" id="visa" name="cardType" value="Visa" required>
    <label for="visa">
        <img src="https://cdn.iconscout.com/icon/free/png-256/free-visa-logo-icon-download-in-svg-png-gif-file-formats--payment-method-gateway-logos-pack-icons-675739.png" alt="Visa" width="40">
    </label>

    <input type="radio" id="mastercard" name="cardType" value="MasterCard" required>
    <label for="mastercard">
        <img src="https://new.sportal365images.com/process/smp-images-production/profit.bg/24012024/e61bef22-9271-4d5d-9406-6e7ff988f4fe.jpg?operations=autocrop(256:256)" alt="MasterCard" width="40">
    </label>
    <br><br>

    <label>Cardholder Name:</label>
    <input type="text" name="cardName" required>
    <label>Card Number:</label>
    <input type="text" name="cardNumber" required>
    <br><br>

    <label>Expiry Date:</label>
    <input type="text" name="expiryDate" required>

    <label>CVC:</label>
    <input type="text" name="cvc" required>
    <br><br>

    <h3>Total Price: <span id="totalPrice">0.00 lv.</span></h3>  <!-- Dynamic Price Update -->

    <button type="submit">Finish Reservation</button>
</form>

<a href="/destinations">Back</a>
</body>
</html>
